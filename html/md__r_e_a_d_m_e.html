<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: Модуль расчета справедливой цены опциона по модели Блека-Шоулза</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('md__r_e_a_d_m_e.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Модуль расчета справедливой цены опциона по модели Блека-Шоулза </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p><b>Модель ценообразования опционов Блэка–Шоулза</b> — это модель, которая определяет теоретическую цену на европейские опционы, подразумевающая, что если базовый актив торгуется на рынке, то цена опциона на него неявным образом уже устанавливается самим рынком. Согласно модели Блэка–Шоулза ключевым элементом определения стоимости опциона является ожидаемая волатильность базового актива. В зависимости от колебания актива цена на него возрастает или понижается, что прямо пропорционально влияет на стоимость опциона. <br  />
Разрабатываемый модуль рассчитывает справедливую цену опционов Call и Put, согласно модели Блэка-Шоулза. <br  />
По модели Блэка-Шоулза считаются опционы для европейских и американских рынков. В данной реализации не используются дивиденды для европейского рынка, для американского - используются.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Структура модуля</h1>
<h2 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
Класс CalculatingFairPriceOfEuropeanOption</h2>
<p>Данный класс предназначен для расчета справедливой цены опциона для европейского рынка. В классе могут рассчитываться как Call, так и Put опционы. <br  />
Для использования класса и получения результата необходимо передать в конструктор класса необходимые параметры:</p><ul>
<li>Рыночная цена базового актива – текущая цена акции, валютной пары или другого актива, лежащего в основе опционного контракта. - S</li>
<li>Страйк – цена, по которой владелец опциона может купить или продать базовый актив до даты экспирации. - X</li>
<li>Время до экспирации – период, оставшийся до истечения срока действия опционного контракта (обычно выражается в годах). - T</li>
<li>Показатель волатильности – мера ожидаемых будущих колебаний цены актива, показывающая его нестабильность, выражается в годовом измерении (на сколько сильно цена может колебаться в среднем за год). – o`</li>
<li>Безрисковая процентная ставка – теоретическая норма доходности по инвестициям с нулевым финансовым риском. - r <br  />
Пример использования класса:</li>
</ul>
<h4 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
<center> C</center></h4>
<div class="fragment"><div class="line">CalculatingFairPriceOfEuropeanOption newOption = <span class="keyword">new</span> CalculatingFairPriceOfEuropeanOption(38.6459, 40, 0.1, 0.5, 0.3);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nS = &quot;</span> + newOption.CurrentPriceOfUnderlyingAsset);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;K = &quot;</span> + newOption.Strike);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;r = &quot;</span> + newOption.RiskFreeInterestRate);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;T = &quot;</span> + newOption.TimeToOptioneExpiration);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;o` = &quot;</span> + newOption.Volatility);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nC = &quot;</span> + newOption.PriceOptionCall);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;P = &quot;</span> + newOption.PriceOptionPut);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nDelta C = &quot;</span> + newOption.GreeksValue.DeltaOptionCall);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Delta P = &quot;</span> + newOption.GreeksValue.DeltaOptionPut);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Gamma = &quot;</span> + newOption.GreeksValue.Gamma);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Vega = &quot;</span> + newOption.GreeksValue.Vega);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Teta C = &quot;</span> + newOption.GreeksValue.TetaOptionCall);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Teta P = &quot;</span> + newOption.GreeksValue.TetaOptionPut);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Ro C = &quot;</span> + newOption.GreeksValue.RoOptionCall);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Ro P = &quot;</span> + newOption.GreeksValue.RoOptionPut);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md5"></a>
Класс CalculatingFairPriceOfAmericanOption</h2>
<p>Данный класс предназначен для расчета справедливой цены опциона для американского рынка. В классе могут рассчитываться только Call цначения опционов. <br  />
Для использования класса и получения результата необходимо передать в конструктор класса необходимые параметры:</p><ul>
<li>Рыночная цена базового актива.</li>
<li>Страйк.</li>
<li>Время до экспирации.</li>
<li>Показатель волатильности.</li>
<li>Безрисковая процентная ставка.</li>
<li>Размеры дивидендов</li>
<li>Сроки до выплаты дивидендов</li>
</ul>
<p>Размеры дивидендов и сроки до выплаты дивидендов - это массивы (обычно из 1-2 значений). Количество элементов массивов должны совпадать (не может быть, что в размерах дивидендов только 1 запись, а в сроках до выплаты 2). ЕСЛИ переданы пустые массивы, то опцион считается без дивидендным и считается, как европейский. <br  />
Пример использования класса:</p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md6"></a>
<center> C</center></h4>
<div class="fragment"><div class="line"> CalculatingFairPriceOfAmericanOption newOption = <span class="keyword">new</span> CalculatingFairPriceOfAmericanOption(40, 40, 0.1, 0.5, 0.3, [0.7, 0.7], [(2.0 / 12), (5.0 / 12)]);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nS = &quot;</span> + newOption.CurrentPriceOfUnderlyingAsset);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;K = &quot;</span> + newOption.Strike);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;r = &quot;</span> + newOption.RiskFreeInterestRate);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;T = &quot;</span> + newOption.TimeToOptioneExpiration);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;o` = &quot;</span> + newOption.Volatility);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nРазмеры дивидендов = [&quot;</span> + <span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;, &quot;</span>, newOption.Dividends) + <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Сроки до выплаты = [&quot;</span> + <span class="keywordtype">string</span>.Join(<span class="stringliteral">&quot;, &quot;</span>, newOption.DividendTimes) + <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nC = &quot;</span> + newOption.PriceOptionCall);</div>
<div class="line"> </div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;\nDelta C = &quot;</span> + newOption.GreeksValue.DeltaOptionCall);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Gamma = &quot;</span> + newOption.GreeksValue.Gamma);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Vega = &quot;</span> + newOption.GreeksValue.Vega);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Teta C = &quot;</span> + newOption.GreeksValue.TetaOptionCall);</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Ro C = &quot;</span> + newOption.GreeksValue.RoOptionCall);</div>
</div><!-- fragment --><p>При попытке обращения к значениям для Put опциона (стоимость Put опциона, греки) выводится сообщение о невозможности получения значения, т.к. Put опцион не рассчитывается для американского рынка.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md7"></a>
Класс CalculatingGreeks</h2>
<p>Данный класс расчитан для подсчета коэффициентов чувствительности опционов (греоков). <br  />
Для использования класса и получения результата необходимо передать в конструктор класса необходимые параметры:</p><ul>
<li>Рыночная цена базового актива.</li>
<li>Страйк.</li>
<li>Время до экспирации.</li>
<li>Показатель волатильности.</li>
<li>Безрисковая процентная ставка.</li>
<li>Коэффициент d1</li>
<li>Коэффициент d2</li>
</ul>
<p>Класс предназначен для использования внутри классов CalculatingFairPriceOfEuropeanOption и CalculatingFairPriceOfAmericanOption. Пример использования класса: </p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md8"></a>
<center> C</center></h4>
<div class="fragment"><div class="line">GreeksValue = <span class="keyword">new</span> CalculatingGreeks(CurrentPriceOfUnderlyingAsset, Strike, RiskFreeInterestRate,</div>
<div class="line">    TimeToOptioneExpiration, Volatility, _d1, _d2);</div>
</div><!-- fragment --><p> После передачи параметров в конструктор производится расчет всех греков.</p>
<hr  />
<h1 class="doxsection"><a class="anchor" id="autotoc_md10"></a>
Система обновления данных</h1>
<p>Система обновления данных создана для пересчета данных об опционах каждые несколько минут (обычно 5). Система может работать самостоятельно, а может быть внедрена в какое-либо другое приложение.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md11"></a>
Класс UpdatingData</h2>
<p>Статический класс, предназначенный для запуска таймера с обновлением данных. Пример использования класса: </p>
<h4 class="doxsection"><a class="anchor" id="autotoc_md12"></a>
<center> C</center></h4>
<div class="fragment"><div class="line">UpdatingData.MainUpdating();</div>
<div class="line">Console.WriteLine(<span class="stringliteral">&quot;Сервис запущен. Нажмите любую клавишу для остановки...&quot;</span>);</div>
<div class="line">Console.ReadKey();</div>
<div class="line"><span class="comment">// Чтобы приложение не завершалось сразу</span></div>
<div class="line">Thread.Sleep(Timeout.Infinite);</div>
</div><!-- fragment --><h2 class="doxsection"><a class="anchor" id="autotoc_md13"></a>
Класс Logging</h2>
<p>Класс для логирования необходим для отслеживания работы программы, определения ошибок, исключений, проблемных мест программы. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
